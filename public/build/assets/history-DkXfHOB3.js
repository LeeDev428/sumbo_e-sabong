import{r,j as e,H as y,a as w}from"./app-Q9Zu66pB.js";import{T as C}from"./teller-layout-DRv04v1P.js";import{H as S}from"./html5-qrcode-scanner-CaUC4haG.js";import{t as d}from"./thermalPrinter-UAHfCUKC.js";import{s as x}from"./toast-kz1Cz6CV.js";import"./app-DbUdHGla.js";function $({bets:m,summary:a}){const[i,h]=r.useState("summary"),[b,n]=r.useState(!1),[c,o]=r.useState(!1),[p,g]=r.useState(!1),l=r.useRef(null);r.useEffect(()=>{d.initialize().then(()=>{g(d.isConnected())});const t=s=>{g(s)};return d.addConnectionListener(t),()=>{d.removeConnectionListener(t)}},[]),r.useEffect(()=>()=>{l.current&&l.current.stop().catch(console.error)},[]);const f=async()=>{try{const t=new S("void-qr-reader");l.current=t,await t.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},s=>{t.stop(),o(!1),confirm(`Void ticket ${s}? This action cannot be undone.`)?w.post("/teller/bets/void",{ticket_id:s},{preserveScroll:!0,onSuccess:()=>{n(!1)},onError:()=>{n(!1)}}):n(!1)},s=>{}),o(!0)}catch(t){console.error(t),o(!1)}},u=()=>{l.current&&l.current.stop().then(()=>{o(!1),n(!1),l.current=null})},j=async t=>{if(!p){x("‚ùå Printer not connected. Connect printer first.","error",3e3);return}try{await d.printTicket({ticket_id:t.ticket_id||`TKT-${t.id}`,fight_number:t.fight.fight_number,side:t.side,amount:t.amount,odds:t.odds||1.95,potential_payout:t.potential_payout,event_name:t.fight.event_name}),x("‚úÖ Receipt reprinted successfully!","success",2e3)}catch(s){console.error("Print error:",s),x(`‚ùå Print failed: ${s.message}`,"error",3e3)}},v=t=>{switch(t.toLowerCase()){case"meron":return"text-red-400";case"wala":return"text-blue-400";case"draw":return"text-green-400";default:return"text-gray-400"}},N=t=>{switch(t.toLowerCase()){case"won":return"bg-green-600";case"lost":return"bg-red-600";case"refunded":return"bg-yellow-600";default:return"bg-gray-600"}};return e.jsxs(C,{currentPage:"history",children:[e.jsx(y,{title:"History & Summary"}),e.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[e.jsx("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-4 border border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-orange-500",children:"History & Summary"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Transaction logs and betting summary"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg font-semibold flex items-center gap-2",children:[e.jsx("span",{children:"‚ùå"})," Void Ticket"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsx("button",{onClick:()=>h("summary"),className:`py-3 rounded-lg font-semibold transition-colors ${i==="summary"?"bg-blue-600 text-white":"bg-[#1a1a1a] text-gray-400 hover:text-white"}`,children:"üìä Summary"}),e.jsx("button",{onClick:()=>h("bets"),className:`py-3 rounded-lg font-semibold transition-colors ${i==="bets"?"bg-blue-600 text-white":"bg-[#1a1a1a] text-gray-400 hover:text-white"}`,children:"üé∞ Bets"})]}),i==="summary"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-900/50 to-purple-900/50 rounded-lg p-6 border border-blue-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"Total Bets Today"}),e.jsx("div",{className:"text-4xl font-bold text-white",children:a.total_bets})]})}),e.jsx("div",{className:"bg-[#1a1a1a] rounded-lg p-6 border border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Total Bet Amount"}),e.jsxs("div",{className:"text-3xl font-bold text-yellow-400",children:["‚Ç±",a.total_amount.toLocaleString()]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"bg-green-900/30 rounded-lg p-4 border border-green-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-green-300 mb-1",children:"Won Bets"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:a.won_bets})]})}),e.jsx("div",{className:"bg-red-900/30 rounded-lg p-4 border border-red-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-red-300 mb-1",children:"Lost Bets"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:a.lost_bets})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"bg-blue-900/30 rounded-lg p-4 border border-blue-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-blue-300 mb-1",children:"Claimed"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:a.claimed_bets})]})}),e.jsx("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-purple-300 mb-1",children:"Voided"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:a.voided_bets})]})})]})]}),i==="bets"&&e.jsx("div",{className:"space-y-3",children:m.data.length===0?e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-8 text-center border border-gray-700",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üé∞"}),e.jsx("p",{className:"text-gray-400",children:"No bets yet"})]}):m.data.map(t=>e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Fight #",t.fight.fight_number]}),e.jsxs("div",{className:"text-lg font-bold",children:[t.fight.meron_fighter," vs ",t.fight.wala_fighter]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${N(t.status)}`,children:t.status.toUpperCase()})]}),t.status==="active"&&e.jsxs("button",{onClick:()=>j(t),className:"w-full mt-3 bg-purple-600 hover:bg-purple-700 py-2 rounded-lg font-semibold text-sm flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üñ®Ô∏è"})," PRINT"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Bet Side"}),e.jsx("div",{className:`text-lg font-bold ${v(t.side)}`,children:t.side.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Amount"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:["‚Ç±",t.amount.toLocaleString()]})]})]}),t.status==="won"&&e.jsxs("div",{className:"bg-green-900/30 rounded-lg p-3 border border-green-500/30",children:[e.jsx("div",{className:"text-xs text-green-300 mb-1",children:"Payout"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["‚Ç±",t.actual_payout?.toLocaleString()]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:new Date(t.created_at).toLocaleString()})]},t.id))})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-[#1a2332] rounded-lg w-full max-w-md border-2 border-red-500",children:[e.jsxs("div",{className:"bg-red-600 px-6 py-3 flex justify-between items-center rounded-t-lg",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx("span",{children:"‚ùå"})," Void Ticket"]}),e.jsx("button",{onClick:()=>{u(),n(!1)},className:"text-white hover:text-gray-200 text-3xl leading-none",children:"√ó"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{id:"void-qr-reader",className:`rounded-lg overflow-hidden mb-4 ${c?"":"hidden"}`}),!c&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì∑"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Scan QR code to void ticket"}),e.jsx("p",{className:"text-sm text-red-400 mb-4",children:"‚ö†Ô∏è This action cannot be undone"}),e.jsx("button",{onClick:f,className:"bg-red-600 hover:bg-red-700 px-8 py-3 rounded-lg font-bold mb-3",children:"Start Scanner"})]}),c&&e.jsx("button",{onClick:u,className:"w-full bg-gray-600 hover:bg-gray-700 py-3 rounded-lg font-bold",children:"Cancel"})]})]})})]})}export{$ as default};
