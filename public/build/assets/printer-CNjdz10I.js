import{r as a,j as e,H as y}from"./app-Q9Zu66pB.js";import{T as N}from"./teller-layout-DRv04v1P.js";import{t as s}from"./thermalPrinter-UAHfCUKC.js";import"./app-DbUdHGla.js";function I(){const[o,l]=a.useState(!1),[P,i]=a.useState(null),[h,r]=a.useState("Not connected"),[u,g]=a.useState(!0),[d,c]=a.useState([]),[m,x]=a.useState(!1);a.useEffect(()=>{s.initialize().then(()=>{const n=s.getConnectedDevice();n?(i(n),l(!0),r(`Connected to ${n.name||"Thermal Printer"}`)):localStorage.getItem("thermal_printer_id")&&r("Reconnecting to printer...")});const t=n=>{l(n),n||(i(null),r("Printer disconnected"))};return s.addConnectionListener(t),()=>{s.removeConnectionListener(t)}},[]);const b=async()=>{try{x(!0),r("Scanning for Bluetooth printers..."),c([]);const t=await s.scan();c(t),t.length===0?r("No printers found. Make sure your printer is on and in pairing mode."):r(`Found ${t.length} device(s). Tap to connect.`)}catch(t){console.error("Scan error:",t),r(`Scan error: ${t.message}`)}finally{x(!1)}},p=async t=>{try{r(`Connecting to ${t.name||t.deviceId}...`),await s.connect(t.deviceId,t.name)?(i(t),l(!0),r(`‚úì Connected to ${t.name||"Thermal Printer"}`),c([])):r("Failed to connect. Please try again.")}catch(n){console.error("Connection error:",n),r(`Error: ${n.message}`)}},f=async()=>{try{await s.disconnect(),i(null),l(!1),r("Disconnected")}catch(t){console.error("Disconnect error:",t)}},j=async()=>{if(!s.isConnected()){alert("Printer not connected!");return}try{r("Printing test receipt..."),await s.printTest(),r("Test print sent successfully!")}catch(t){console.error("Print error:",t),r(`Print error: ${t.message}`),alert(`Print failed: ${t.message}

Make sure the printer is on and connected.`)}},v=()=>{localStorage.removeItem("thermal_printer_id"),localStorage.removeItem("thermal_printer_name"),r("Saved device cleared")};return e.jsxs(N,{children:[e.jsx(y,{title:"Printer Settings"}),e.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-4 border border-gray-700",children:[e.jsx("h1",{className:"text-2xl font-bold text-orange-500",children:"Printer Settings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Connect to Bluetooth Thermal Printer"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Compatible: PT-210, POS Printers, ESC/POS Thermal Printers"})]}),e.jsx("div",{className:`rounded-lg p-6 mb-4 border ${o?"bg-green-900/30 border-green-500/30":"bg-red-900/30 border-red-500/30"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-5xl",children:o?"üñ®Ô∏è‚úÖ":"üñ®Ô∏è‚ùå"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold mb-1 text-white",children:o?"Printer Connected":"Printer Not Connected"}),e.jsx("div",{className:"text-sm text-gray-300",children:h})]})]})}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 mb-4 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Connection"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:t=>g(t.target.checked),className:"w-5 h-5"}),e.jsx("span",{className:"text-white",children:"Remember this printer"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 ml-7",children:"Automatically reconnect to this printer next time"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[o?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:f,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-bold text-base sm:text-lg",children:"Disconnect"}),e.jsx("button",{onClick:j,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-bold text-base sm:text-lg",children:"üñ®Ô∏è Test Print"})]}):e.jsx("button",{onClick:b,disabled:m,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed rounded-lg font-bold text-base sm:text-lg",children:m?"üîç Scanning...":"üîó Scan for Printers"}),e.jsx("button",{onClick:v,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg font-bold text-base sm:text-lg",children:"Clear Saved Device"})]}),d.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Available Printers:"}),e.jsx("div",{className:"space-y-2",children:d.map((t,n)=>e.jsxs("button",{onClick:()=>p(t),className:"w-full bg-[#2a3544] hover:bg-[#3a4554] text-left p-3 rounded-lg border border-gray-600 transition-colors",children:[e.jsx("div",{className:"font-semibold text-white",children:t.name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-gray-400 truncate",children:t.deviceId})]},t.deviceId||n))})]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 mb-4 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Account"}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to logout?")&&router.post("/logout")},className:"w-full px-6 py-4 bg-red-600 hover:bg-red-700 rounded-lg font-bold text-lg flex items-center justify-center gap-2",children:"üö™ Logout"})]}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-600/50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-3",children:"‚ö†Ô∏è Important Notes"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"‚Ä¢ Make sure Bluetooth is enabled on your device"}),e.jsx("li",{children:"‚Ä¢ The PT-210 printer must be turned on and in pairing mode"}),e.jsx("li",{children:"‚Ä¢ Keep the printer within Bluetooth range (approximately 10 meters)"}),e.jsx("li",{children:"‚Ä¢ Receipts will print automatically after each bet is placed"}),e.jsx("li",{children:"‚Ä¢ This feature requires a browser with Web Bluetooth API support (Chrome/Edge recommended)"})]})]})]})]})}export{I as default};
