import{r,j as e,H as N}from"./app-CbIbn4Ys.js";import{T as y}from"./teller-layout-CWN8YCxz.js";import{t as n}from"./thermalPrinter-CNbcWwX9.js";import"./app-DYXMlGDN.js";function T(){const[l,c]=r.useState(!1),[w,o]=r.useState(null),[h,s]=r.useState("Not connected"),[b,u]=r.useState(!0),[d,i]=r.useState([]),[x,m]=r.useState(!1);r.useEffect(()=>{n.initialize().then(()=>{localStorage.getItem("thermal_printer_id")&&s("Previously connected printer saved")})},[]);const g=async()=>{try{m(!0),s("Scanning for Bluetooth printers..."),i([]);const t=await n.scan();i(t),t.length===0?s("No printers found. Make sure your printer is on and in pairing mode."):s(`Found ${t.length} device(s). Tap to connect.`)}catch(t){console.error("Scan error:",t),s(`Scan error: ${t.message}`)}finally{m(!1)}},p=async t=>{try{s(`Connecting to ${t.name||t.deviceId}...`),await n.connect(t.deviceId)?(o(t),c(!0),s(`Connected to ${t.name||"Thermal Printer"}`),i([])):s("Failed to connect. Please try again.")}catch(a){console.error("Connection error:",a),s(`Error: ${a.message}`)}},j=async()=>{try{await n.disconnect(),o(null),c(!1),s("Disconnected")}catch(t){console.error("Disconnect error:",t)}},f=async()=>{if(!n.isConnected()){alert("Printer not connected!");return}try{s("Printing test receipt..."),await n.printTest(),s("Test print sent successfully!")}catch(t){console.error("Print error:",t),s(`Print error: ${t.message}`),alert(`Print failed: ${t.message}

Make sure the printer is on and connected.`)}},v=()=>{localStorage.removeItem("thermal_printer_id"),localStorage.removeItem("thermal_printer_name"),s("Saved device cleared")};return e.jsxs(y,{children:[e.jsx(N,{title:"Printer Settings"}),e.jsxs("div",{className:"p-4 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-4 mb-4 border border-gray-700",children:[e.jsx("h1",{className:"text-2xl font-bold text-orange-500",children:"Printer Settings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Connect to Bluetooth Thermal Printer"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Compatible: PT-210, POS Printers, ESC/POS Thermal Printers"})]}),e.jsx("div",{className:`rounded-lg p-6 mb-4 border ${l?"bg-green-900/30 border-green-500/30":"bg-red-900/30 border-red-500/30"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-5xl",children:l?"üñ®Ô∏è‚úÖ":"üñ®Ô∏è‚ùå"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold mb-1 text-white",children:l?"Printer Connected":"Printer Not Connected"}),e.jsx("div",{className:"text-sm text-gray-300",children:h})]})]})}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 mb-4 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Connection"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:t=>u(t.target.checked),className:"w-5 h-5"}),e.jsx("span",{className:"text-white",children:"Remember this printer"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 ml-7",children:"Automatically reconnect to this printer next time"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-bold text-base sm:text-lg",children:"Disconnect"}),e.jsx("button",{onClick:f,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-bold text-base sm:text-lg",children:"üñ®Ô∏è Test Print"})]}):e.jsx("button",{onClick:g,disabled:x,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed rounded-lg font-bold text-base sm:text-lg",children:x?"üîç Scanning...":"üîó Scan for Printers"}),e.jsx("button",{onClick:v,className:"w-full sm:w-auto px-4 sm:px-6 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg font-bold text-base sm:text-lg",children:"Clear Saved Device"})]}),d.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Available Printers:"}),e.jsx("div",{className:"space-y-2",children:d.map((t,a)=>e.jsxs("button",{onClick:()=>p(t),className:"w-full bg-[#2a3544] hover:bg-[#3a4554] text-left p-3 rounded-lg border border-gray-600 transition-colors",children:[e.jsx("div",{className:"font-semibold text-white",children:t.name||"Unknown Device"}),e.jsx("div",{className:"text-xs text-gray-400 truncate",children:t.deviceId})]},t.deviceId||a))})]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 mb-4 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-orange-500 mb-4",children:"Receipt Preview"}),e.jsxs("div",{className:"bg-white text-black p-6 rounded font-mono text-sm max-w-md",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:"font-bold text-lg",children:"Sabing2m Arena"}),e.jsx("div",{className:"text-xs",children:"BET RECEIPT"}),e.jsx("div",{className:"border-t border-b border-black my-2 py-1",children:e.jsx("div",{className:"font-bold",children:"TICKET #12345"})})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Fight:"}),e.jsx("span",{className:"font-bold",children:"#42"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Side:"}),e.jsx("span",{className:"font-bold",children:"MERON"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Amount:"}),e.jsx("span",{className:"font-bold",children:"‚Ç±500.00"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Odds:"}),e.jsx("span",{className:"font-bold",children:"1.57x"})]})]}),e.jsx("div",{className:"border-t border-black pt-2 mb-3",children:e.jsxs("div",{className:"flex justify-between font-bold text-base",children:[e.jsx("span",{children:"Potential Win:"}),e.jsx("span",{children:"‚Ç±785.00"})]})}),e.jsxs("div",{className:"text-xs text-center border-t border-black pt-2",children:[e.jsx("div",{children:new Date().toLocaleString()}),e.jsx("div",{className:"mt-2",children:"Good Luck!"})]})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-4",children:"This receipt will be printed automatically after each bet placement"})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-6 mb-4 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Account"}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to logout?")&&router.post("/logout")},className:"w-full px-6 py-4 bg-red-600 hover:bg-red-700 rounded-lg font-bold text-lg flex items-center justify-center gap-2",children:"üö™ Logout"})]}),e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-600/50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-3",children:"‚ö†Ô∏è Important Notes"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsx("li",{children:"‚Ä¢ Make sure Bluetooth is enabled on your device"}),e.jsx("li",{children:"‚Ä¢ The PT-210 printer must be turned on and in pairing mode"}),e.jsx("li",{children:"‚Ä¢ Keep the printer within Bluetooth range (approximately 10 meters)"}),e.jsx("li",{children:"‚Ä¢ Receipts will print automatically after each bet is placed"}),e.jsx("li",{children:"‚Ä¢ This feature requires a browser with Web Bluetooth API support (Chrome/Edge recommended)"})]})]})]})]})}export{T as default};
