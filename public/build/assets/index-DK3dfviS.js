import{c as te,r as k,j as s,a as N,H as le}from"./app-CXTbrIuM.js";import{A as ae}from"./admin-layout-DEqqeNKh.js";import{P as ne}from"./pagination-DrLDulAN.js";import"./app-uwIt0fpx.js";function fe(r){const e=te.c(74),{fights:n,tellers:y}=r,[c,z]=k.useState(null),[J,K]=k.useState(!1),[u,Q]=k.useState(null);let L;e[0]===Symbol.for("react.memo_cache_sentinel")?(L={},e[0]=L):L=e[0];const[d,X]=k.useState(L);let E;e[1]===Symbol.for("react.memo_cache_sentinel")?(E={},e[1]=E):E=e[1];const[a,w]=k.useState(E),D=n.data[0];D&&D.status==="result_declared"&&D.result&&D.result;const ee=ge,se=xe;let R;e[2]===Symbol.for("react.memo_cache_sentinel")?(R=(l,t)=>{N.post(`/admin/fights/${l}/status`,{status:t},{preserveScroll:!0,onSuccess:()=>{K(!1),z(null)}})},e[2]=R):R=e[2];const P=R;let _;e[3]!==d||e[4]!==a?(_=l=>{Q(l.id),X({...d,[l.id]:(l.revolving_funds||0).toString()});const t=l.teller_assignments?.map(me)||[];w({...a,[l.id]:t})},e[3]=d,e[4]=a,e[5]=_):_=e[5];const S=_;let B;e[6]!==d||e[7]!==a?(B=l=>{Q(null);const t={...d};delete t[l],X(t);const i={...a};delete i[l],w(i)},e[6]=d,e[7]=a,e[8]=B):B=e[8];const C=B;let M;e[9]!==a?(M=l=>{const t=a[l]||[];w({...a,[l]:[...t,{teller_id:"",amount:"0"}]})},e[9]=a,e[10]=M):M=e[10];const A=M;let $;e[11]!==n.data||e[12]!==a?($=(l,t,i,m)=>{const x=[...a[l]||[]];if(i==="teller_id"&&m){const I=n.data.find(Z=>Z.id===l)?.teller_cash_assignments?.find(Z=>Z.teller_id===parseInt(m));x[t]={...x[t],[i]:m,amount:I?I.current_balance.toString():"0"}}else x[t]={...x[t],[i]:m};w({...a,[l]:x})},e[11]=n.data,e[12]=a,e[13]=$):$=e[13];const p=$;let H;e[14]!==a?(H=(l,t)=>{const i=[...a[l]||[]];i.splice(t,1),w({...a,[l]:i})},e[14]=a,e[15]=H):H=e[15];const F=H;let O;e[16]!==a?(O=l=>(a[l]||[]).reduce(oe,0),e[16]=a,e[17]=O):O=e[17];const g=O;let G;e[18]!==g||e[19]!==d?(G=l=>parseFloat(d[l]||"0")-g(l),e[18]=g,e[19]=d,e[20]=G):G=e[20];const o=G;let U;e[21]!==o||e[22]!==d||e[23]!==a?(U=l=>{if(o(l)<0){alert("âš ï¸ Total assignments exceed revolving funds! Please adjust the amounts.");return}const i=a[l]||[];N.post(`/admin/fights/${l}/funds`,{revolving_funds:d[l]||"0",teller_assignments:i},{preserveScroll:!0,onSuccess:()=>{Q(null)}})},e[21]=o,e[22]=d,e[23]=a,e[24]=U):U=e[24];const T=U;let q;e[25]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx(le,{title:"Fights Management"}),e[25]=q):q=e[25];let V;e[26]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-white mb-1 lg:mb-2",children:"Fights Management"}),s.jsx("p",{className:"text-sm lg:text-base text-gray-400",children:"Manage and control all cockfighting events"})]}),e[26]=V):V=e[26];let W;e[27]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 lg:mb-8",children:[V,s.jsx("div",{className:"flex gap-3 w-full sm:w-auto",children:s.jsx("button",{onClick:ce,className:"flex-1 sm:flex-none px-4 sm:px-6 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm sm:text-base whitespace-nowrap",children:"+ Create New Fight"})})]}),e[27]=W):W=e[27];let b;if(e[28]!==A||e[29]!==C||e[30]!==u||e[31]!==n.data||e[32]!==o||e[33]!==g||e[34]!==F||e[35]!==d||e[36]!==T||e[37]!==S||e[38]!==a||e[39]!==y||e[40]!==p){let l;e[42]!==A||e[43]!==C||e[44]!==u||e[45]!==o||e[46]!==g||e[47]!==F||e[48]!==d||e[49]!==T||e[50]!==S||e[51]!==a||e[52]!==y||e[53]!==p?(l=t=>s.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 sm:p-6 lg:p-8 hover:bg-gray-750 transition-colors",children:s.jsxs("div",{className:"flex flex-col lg:flex-row items-start justify-between gap-4 lg:gap-6",children:[s.jsxs("div",{className:"flex-1 w-full lg:w-auto",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-3 lg:gap-4 mb-3 lg:mb-4",children:[s.jsxs("div",{className:"text-2xl lg:text-3xl font-bold text-white",children:["#",t.fight_number]}),s.jsx("span",{className:`px-3 lg:px-4 py-1 rounded-full text-xs lg:text-sm font-medium ${ee(t.status)}`,children:se(t.status)}),t.result&&s.jsxs("span",{className:"px-3 lg:px-4 py-1 bg-purple-600 rounded-full text-xs lg:text-sm font-medium",children:["Result: ",t.result.toUpperCase()]})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 lg:gap-4 mb-4 lg:mb-6",children:[s.jsxs("div",{className:"bg-red-900/30 border border-red-700 rounded-lg p-3 lg:p-4",children:[s.jsx("div",{className:"text-xs text-red-300 mb-2",children:"MERON"}),s.jsx("div",{className:"text-sm lg:text-base font-bold text-white mb-2 truncate",children:t.meron_fighter}),s.jsxs("div",{className:"text-xl lg:text-2xl font-bold text-red-400",children:[t.meron_odds||"---","x"]})]}),s.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-3 lg:p-4",children:[s.jsx("div",{className:"text-xs text-green-300 mb-2",children:"DRAW"}),s.jsx("div",{className:"text-sm lg:text-base font-bold text-white mb-2",children:"Match Draw"}),s.jsxs("div",{className:"text-xl lg:text-2xl font-bold text-green-400",children:[t.draw_odds||"---","x"]})]}),s.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-3 lg:p-4",children:[s.jsx("div",{className:"text-xs text-blue-300 mb-2",children:"WALA"}),s.jsx("div",{className:"text-sm lg:text-base font-bold text-white mb-2 truncate",children:t.wala_fighter}),s.jsxs("div",{className:"text-xl lg:text-2xl font-bold text-blue-400",children:[t.wala_odds||"---","x"]})]}),s.jsx("div",{className:"flex items-center justify-center col-span-2 sm:col-span-1",children:s.jsx("div",{className:"text-3xl lg:text-4xl font-bold text-gray-600",children:"VS"})})]}),s.jsxs("div",{className:"mt-6 border-t border-gray-700 pt-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h4",{className:"text-lg font-bold text-white",children:"ðŸ’° Funds & Teller Cash Distribution"}),u===t.id?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>T(t.id),className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-sm",children:"ðŸ’¾ Save"}),s.jsx("button",{onClick:()=>C(t.id),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-sm",children:"Cancel"})]}):s.jsx("button",{onClick:()=>S(t),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm",children:"âœï¸ Edit Funds"})]}),u===t.id?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2 text-green-400",children:"Revolving Funds (â‚±)"}),s.jsx("input",{type:"number",step:"0.01",value:d[t.id]||"0",onChange:i=>X({...d,[t.id]:i.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500",placeholder:"0.00"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Total funds available for teller assignments"})]}),s.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Assign Cash to Tellers"}),s.jsx("button",{type:"button",onClick:()=>A(t.id),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm",children:"+ Add Teller"})]}),(a[t.id]||[]).length===0?s.jsx("p",{className:"text-gray-400 text-sm",children:'No tellers assigned yet. Click "Add Teller" to assign cash.'}):s.jsx("div",{className:"space-y-3",children:(a[t.id]||[]).map((i,m)=>s.jsxs("div",{className:"flex gap-3 items-end bg-gray-700 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs font-medium mb-1",children:"Teller"}),s.jsxs("select",{value:i.teller_id,onChange:x=>p(t.id,m,"teller_id",x.target.value),className:"w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-lg text-sm",required:!0,children:[s.jsx("option",{value:"",children:"Select Teller"}),y.map(ie)]})]}),s.jsxs("div",{className:"w-40",children:[s.jsx("label",{className:"block text-xs font-medium mb-1",children:"Amount (â‚±)"}),s.jsx("input",{type:"number",step:"0.01",value:i.amount,onChange:x=>p(t.id,m,"amount",x.target.value),className:"w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-lg text-sm",placeholder:"0.00",required:!0})]}),s.jsx("button",{type:"button",onClick:()=>F(t.id,m),className:"px-3 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"Remove"})]},m))}),(a[t.id]||[]).length>0&&s.jsxs("div",{className:"mt-4 bg-gray-900 p-4 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Revolving Funds:"}),s.jsxs("span",{className:"text-white",children:["â‚±",parseFloat(d[t.id]||"0").toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Total Assigned:"}),s.jsxs("span",{className:"text-yellow-400",children:["â‚±",g(t.id).toLocaleString()]})]}),s.jsxs("div",{className:"flex justify-between text-sm font-bold border-t border-gray-700 pt-2",children:[s.jsx("span",{children:"Remaining:"}),s.jsxs("span",{className:o(t.id)<0?"text-red-400":"text-green-400",children:["â‚±",o(t.id).toLocaleString()]})]}),o(t.id)<0&&s.jsx("p",{className:"text-red-400 text-xs mt-2",children:"âš ï¸ Total assignments exceed revolving funds!"})]})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Revolving Funds"}),s.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["â‚±",(t.revolving_funds||0).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),t.teller_assignments&&t.teller_assignments.length>0?s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-400 mb-2",children:"Assigned Tellers"}),s.jsx("div",{className:"space-y-2",children:t.teller_assignments.map(de)}),s.jsx("div",{className:"mt-3 bg-gray-900 p-3 rounded-lg",children:s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Total Assigned:"}),s.jsxs("span",{className:"font-bold text-white",children:["â‚±",t.teller_assignments.reduce(re,0).toLocaleString("en-PH",{minimumFractionDigits:2})]})]})})]}):s.jsx("div",{className:""})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6 text-xs lg:text-sm text-gray-400 mt-6",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Created:"})," ",s.jsx("span",{className:"block sm:inline",children:new Date(t.created_at).toLocaleString()})]}),t.scheduled_at&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Scheduled:"})," ",s.jsx("span",{className:"block sm:inline",children:new Date(t.scheduled_at).toLocaleString()})]})]})]}),s.jsxs("div",{className:"flex flex-row lg:flex-col gap-2 lg:gap-3 w-full lg:w-auto lg:min-w-[160px]",children:[s.jsx("button",{onClick:()=>{z(t),K(!0)},className:"flex-1 lg:flex-none px-3 lg:px-4 py-2 lg:py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-xs lg:text-sm font-medium whitespace-nowrap",children:"Change Status"}),s.jsx("button",{onClick:()=>N.visit(`/admin/fights/${t.id}/edit`),className:"flex-1 lg:flex-none px-3 lg:px-4 py-2 lg:py-2.5 bg-blue-700 hover:bg-blue-600 rounded-lg text-xs lg:text-sm font-medium whitespace-nowrap",children:"Edit Details"}),s.jsx("button",{onClick:()=>N.visit(`/admin/fights/${t.id}`),className:"flex-1 lg:flex-none px-3 lg:px-4 py-2 lg:py-2.5 bg-purple-700 hover:bg-purple-600 rounded-lg text-xs lg:text-sm font-medium whitespace-nowrap",children:"View"}),t.status==="closed"&&!t.result&&s.jsx("button",{onClick:()=>N.visit(`/admin/fights/${t.id}/declare-result`),className:"flex-1 lg:flex-none px-3 lg:px-4 py-2 lg:py-2.5 bg-green-700 hover:bg-green-600 rounded-lg text-xs lg:text-sm font-medium whitespace-nowrap",children:"Declare Result"})]})]})},t.id),e[42]=A,e[43]=C,e[44]=u,e[45]=o,e[46]=g,e[47]=F,e[48]=d,e[49]=T,e[50]=S,e[51]=a,e[52]=y,e[53]=p,e[54]=l):l=e[54],b=n.data.map(l),e[28]=A,e[29]=C,e[30]=u,e[31]=n.data,e[32]=o,e[33]=g,e[34]=F,e[35]=d,e[36]=T,e[37]=S,e[38]=a,e[39]=y,e[40]=p,e[41]=b}else b=e[41];let h;e[55]!==n.data.length?(h=n.data.length===0&&s.jsxs("div",{className:"text-center py-12 text-gray-400",children:[s.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ®"}),s.jsx("p",{className:"text-xl font-medium mb-2",children:"No fights yet"}),s.jsx("p",{className:"text-sm",children:"Create your first fight to get started"})]}),e[55]=n.data.length,e[56]=h):h=e[56];let j;e[57]!==n.current_page||e[58]!==n.from||e[59]!==n.last_page||e[60]!==n.links||e[61]!==n.to||e[62]!==n.total?(j=s.jsx(ne,{currentPage:n.current_page,lastPage:n.last_page,from:n.from,to:n.to,total:n.total,links:n.links}),e[57]=n.current_page,e[58]=n.from,e[59]=n.last_page,e[60]=n.links,e[61]=n.to,e[62]=n.total,e[63]=j):j=e[63];let f;e[64]!==b||e[65]!==h||e[66]!==j?(f=s.jsxs("div",{className:"p-4 lg:p-8",children:[W,s.jsxs("div",{className:"grid gap-4 lg:gap-6",children:[b,h,j]})]}),e[64]=b,e[65]=h,e[66]=j,e[67]=f):f=e[67];let v;e[68]!==c||e[69]!==J?(v=J&&c&&s.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full border border-gray-700",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Change Status - Fight #",c.fight_number]}),s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsx("button",{onClick:()=>P(c.id,"standby"),disabled:c.status==="standby",className:"w-full px-4 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg text-left font-medium disabled:opacity-50",children:"â¸ï¸ STANDBY"}),s.jsx("button",{onClick:()=>P(c.id,"open"),disabled:c.status==="open",className:"w-full px-4 py-3 bg-green-600 hover:bg-green-700 rounded-lg text-left font-medium disabled:opacity-50",children:"âœ… OPEN BETTING"}),s.jsx("button",{onClick:()=>P(c.id,"lastcall"),disabled:c.status==="lastcall",className:"w-full px-4 py-3 bg-yellow-600 hover:bg-yellow-700 rounded-lg text-left font-medium disabled:opacity-50",children:"âš ï¸ LAST CALL"}),s.jsx("button",{onClick:()=>P(c.id,"closed"),disabled:c.status==="closed",className:"w-full px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg text-left font-medium disabled:opacity-50",children:"ðŸ”’ CLOSE BETTING"})]}),s.jsx("button",{onClick:()=>{K(!1),z(null)},className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"})]})}),e[68]=c,e[69]=J,e[70]=v):v=e[70];let Y;return e[71]!==f||e[72]!==v?(Y=s.jsxs(ae,{children:[q,f,v]}),e[71]=f,e[72]=v,e[73]=Y):Y=e[73],Y}function re(r,e){return r+e.assigned_amount}function de(r){return s.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-white",children:r.teller.name}),s.jsx("div",{className:"text-xs text-gray-400",children:r.teller.email})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-400",children:"Assigned"}),s.jsxs("div",{className:"font-bold text-yellow-400",children:["â‚±",r.assigned_amount.toLocaleString("en-PH",{minimumFractionDigits:2})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Balance: â‚±",r.current_balance.toLocaleString("en-PH",{minimumFractionDigits:2})]})]})]},r.id)}function ie(r){return s.jsxs("option",{value:r.id,children:[r.name," (",r.email,")"]},r.id)}function ce(){return N.visit("/admin/fights/create")}function oe(r,e){return r+parseFloat(e.amount||"0")}function me(r){return{teller_id:r.teller_id.toString(),amount:r.assigned_amount.toString(),teller_name:r.teller?.name||"Unknown"}}function xe(r){switch(r){case"standby":return"STANDBY";case"open":return"BETTING OPEN";case"lastcall":return"LAST CALL";case"closed":return"BETTING CLOSED";case"result_declared":return"RESULT DECLARED";case"cancelled":return"CANCELLED";default:return r.toUpperCase()}}function ge(r){switch(r){case"standby":return"bg-gray-600";case"open":return"bg-green-600";case"lastcall":return"bg-yellow-600";case"closed":return"bg-red-600";case"result_declared":return"bg-blue-600";case"cancelled":return"bg-gray-500";default:return"bg-gray-600"}}export{fe as default};
